# Q & A

### 3주차 질문

#### Q. Path를 설정하지 않으면 어디를 기본으로 찾는 대상으로 설정되게 되나요?

버전별 상이한 기본 설정값 CMake 페이지에서 설명(영상참조)

### Q. GLOB을 사용하면 안된다고 하는 사람들이 있는데, 다른 탐색법이 있는지 궁금합니다.

보통 파일 하나하나 직접 작성해서 문제가 나면 CMakeLists.txt만 확인하는 편(GLOB이 부정되는 이유)
프로젝트 관리방식에 따라 폴더를 여럿으로 나누어서 관리하는 경우 GLOB은 좋은 선택이 될 수 있음.

### Q. 외부 라이브러리를 쓸 때는 거의 항상 find_package, find_library를 쓰시는 편인가요? 프로젝트 내부에 external directory에 외부라이브러리 소스들을 모아놓고 add_subdirectory를 사용하는 레포들도 있던데 차이점이 뭐가있을지 궁금합니다

find_Library, find_subdirectory를 더 선호해야 하는 것이 맞다고 생각합니다.
add_subdirectory를 사용하게되면 경로 변경에 의하여 결과가 달라질 수 있기 때문.
find를 사용해서 타겟을 만들고 타겟을 관리하는것이 좋다고 생각합니다.

4.
Q.
 (Conan이)디게 매력적인것같아요. vcpkg랑 비교하면 어떤가요?
A.
 폴더 구성이 바뀌게 되어있어 조직 특성에 따라 선택적으로 사용하는 것이 좋다고 생각합니다.
   vcpkg는 패키지 라이브러리 설치 옵션을 통해 사이즈 조절이 되지만 코난에는 없습니다.

5.
Q.
 FindXXX.cmake는 라이브러리 배포자가아닌데 직접 만들어야할일도있나요?
A.
 조금 규모가 있는 프로젝트는 많이 하고 있습니다.

4주차 질문

1.
Q.
 cpp_14 cpp+17 다르게 쓰신 이유가 있나요?
A.
 오타입니다.
Q.
 오타인데 제대로 된 것인가요?
A.
 변수 이름이고 스크립트이기 때문에 정상동작합니다.

2.
Q.
 Function의 리턴 자료형이 모두 문자열로만 나온다고 들었는데 맞는지 궁금합니다. 어차피 스크립트여서 원래 반환형에 구분이 없는걸까요?
A.
 네, 기본적으로 String으로 설정되어 있어서 올바른 것으로 보입니다.
    부가적으로 변수를 함수 안에서 선언에서 쓰려면 Parent_Scope라는 선언을 사용해야 합니다. 사용하지 않으면 함수 밖에서 쓸 수 없습니다.
Q.
 일종의 함수를 호출한 스택 스코프에 선언하는 변수이다 같은 느낌일까요?
A.
 네, 함수를 호출한 SubDirectory 에서 사용하는 변수이다. 가 됩니다.

3.
Q.
 (CMake Python 기능이)콘다 가상환경도 찾아주나요?
A.
 네. 찾아줍니다.

4.
Q.
 이렇게 보니 Hints가 C++에서의 #ifndef 같은 느낌이 드는군요
A.
 그렇게도 볼 수 있지만 CMakeCache의 존재가 다른점을 만들어내고 있습니다.

5.
Q.
 find_package나 find_library나 PATH 설정을 신중히 하는게 중요해보이는데 보통 플랫폼마다 하나하나 다 하드코딩해서 넣어주나요?
A.
 저는 그렇게 하는 편입니다.
    CMake User Interface 문서를 참조해서 기본값을 설정하는것이 중요합니다.
    그리고 이런 부분들을 햇갈리지 않고 작업하기 위해 최상위 위치에서 기본적인 설정을 하는 영역을 만들어서 추가하면 좋다고 생각합니다.

6.
Q.
 나중에 자신이 dll을 만들어서 이런 타겟 패키징으로 만드는 부분도 다루시는지 궁금합니다.
A.
 6주차때 진행 할 예정입니다.

7.
Q.
 이 스터디에서 진행하는 내용이 CMake 를 다루는데 몇 %정도 다루시는 것인지 궁금합니다.

A.
 워낙 방대해서 %로 나타내긴 어렵고, 어디를 100% 하기 어렵지만 제(동하님) 기준으로 기본적으로 프로젝트를 진행하기 위해 필요한 범위의 80%는 다루었습니다.

5주차 질문

1
Q.
 중간에 nsync_cpp 옵션이라거나 이런걸 바로 생각해내서 쓰시는 부분은 nsync 프로젝트를 써보시면서 조금 익히셨던 건가요?
 저는 이런 식의 프로젝트 관리자에서 어려운게 가끔 필요한 게 생각나서 찾고 싶을때 검색 문구가 생각 안나면 시간이 다 날아가더라구요
A.
 (영상에서 보여드리는 실행은)한 번 찾아봤기 때문에 가능한 일.
 영상에서 보여드리기 위해 미리 다 확인을 해서 금방금방 찾아서 보여드리고 있는데 한 번 실행해서 찾아놓는 수 밖에 없습니다.

2
Q.
 설명하시면서 쭉 지나가졌지만 결국 이런 CMakeLists.txt같은 문서를 볼 때 어떤 CMake 변수에 집중하거나 어떤 CMake 함수에 집중하거나 무엇에 대해 고민해야 하는가에 대한 키 포인트적인 단어가 없는 것 같은데
 이 부분은 추천해주신 책에서 나오는 여러가지 빌드 방법론에 대한 내용에 대해 파악하고 접근해야 보이게 될 까요?
A.
 굉장히 휴리스틱적인 문제로 보입니다.
 빌드 테스팅이나 예제를 집중적으로 봐야 합니다.
 특정 폴더에서 인스톨을 해놓고 빌드를 하면서 어떤 파일들이 인스톨 되는가 등에 대해 보게 되었습니다.
 개인적으로는 CMake Tutorial 혹은 CGold를 쭉 살펴보시는게 제일 좋다고 생각합니다.
3
Q.
 CMake에서 Lists파일 분리를 통해서 옵션을 나눠놓고 쓴다거나 하는 구성이 가능할까요?
A.
 프로젝트 폴더 전체에서 검색을 해야 합니다.
 특정 조건에 따라 갑자기 옵션이 세팅되는 위치가 있기도 해서 말씀하신 대로 분리는 시킬 수 있는데 옵션을 찾기 어려워집니다.
 동하님 의견 제안
 여러가지 프로젝트를 만들게 되면 일정 단위에서 끊는것이 좋다고 생각합니다.
 재귀적 구성이나 프로젝트가 여러개가 되다보면 설정이 감당하기 어려울 정도로 커지기 때문에 모듈화가 중요하다고 생각합니다.
4
Q.
 여러 프로젝트를 한번에 관리하기 어렵다면 VS를 쓰는게 낫겠군요
A.
 네, 플렛폼 종속적이어도 관계 없다면 차라리 그렇게 사용하는것이 더 낫다고 생각합니다.

6주차 질문

1
Q.
 Package 질문 - Vulkan / MiMalloc/ Qt 확인
A.
 Conan Center에서 검색하여 확인 완료

2
Q.
 Conan의 Cmake Package 명령을 사용했을때, CMakeLists.txt를 자동으로 생성 해 준다거나 하는건가요?
A.
 find_openssl.cmake 같이 Cmake에서 find_package를 할 수 있게 해줍니다.

3
Q.
 폴더 깊이가 낮을때 얻는 가장 큰 장점은 무엇이라고 생각하시나요?
A.
 빌드 설정의 복잡도를 낮추고 빌드 오류를 줄일 수 있게 됩니다.

4
Q.
 점점 Cmake랑 멀어지는 느낌..ㅇ<-<
A.
 CMake 만이 능사가 아님을 전달하고 싶었습니다.

5
Q.
 혹시 File Tree 구조나 재귀 관리에 대해서 알고계신 자료가 있으신가요?
 예전에 GLOB을 사용해서 검색하는거 찾을때도 관련된 자료는 거의 안나오고 GLOB은 쓰면 안된다는 자료만 나와서 궁금합니다...
A.
 다른 사람들이 한 것을 볼 수 밖에 없을것 같습니다.

6
Q.
 특정 패키지만 걷어낼때 의존성 검사해서 의존성 0된 패키지만 들어내는 기능이 있나요?
A.
 Ubuntu APT Package의 Auto-Remove 같은 기능은 없습니다.

7
Q.
 어떤 프로젝트보면.. 빌드에서 버전정보나 옵션에대한 명시도없이 빌드해서 폴더에 넣어두는 경우도 봤는데. 최소한 코난을 쓰면, 버전업데이트에대한 부담도 줄어들것같고. 정보도남으니 좋은것같아요
A.
 메타데이터를 강제하는게 좋은 것 같다고 생각합니다.

8
Q.
 파이썬 아나콘다 같은게 Cmake에도 나와야 할텐데 흑흑
A.
 (요 부분 답변은 정리를 하지 못했습니다 ㅠㅠ)

9
Q.
 저는 기존에 의존성 관리를 hunter를 이용했었는데요. 이제 conan을 많이들 사용하시는 것 같더라고요. hunter는 이제 사양길인지..
A.
 생태계에서 이 툴을 얼마나 적극적으로 쓰려고 하는가, 얼마나 패키지를 잘 지원하는가에 대한 기능적 측면이 있는데,
 인식의 문제가 있다고 생각합니다.

10
Q.
 쓰는 사람 수가 압도적으로 많아버리면 무슨 뱀처럼 다소 불합리해도 흥하는게 보통이라..
 cmake와 코난을 묶어서 배우는게 제일 좋겠다는 생각이 듭니다
A.
 이 방식의 접근법도 좋을 것 같습니다.(역시 추가로 말 해 주신걸 잘 요약하지 못했습니다.)

11
Q.
 자체 라이브러리 묶음을 만들어서 나중에 하나의 프로그램으로 올리고 싶은데...
 이런 환경에 대한 배려는 잘 없고, 특정 단독 프로그램 빌드를 외부의 3rd Party로 받아와서 쓰는 환경만 구축되는거 같아서 슬픈거 같습니다.
 특화한 하나의 프로젝트가 잘 나오는것도 좋지만 전체 흐름을 보려고 하는 프로젝트 지원은 점점 등한시 되는거 같습니다...
 CMake에서 가장 고통받는 부분이구요...
 Dll을 여러게 빌드하면서 동시에 Exe프로그램을 구성하게 되면 계속 빌드하면서 고치고 빌드하면서 고치고 하고 싶은데
 타겟화하면 Dll 수정 생길 때 마다 재배포 기다리는게 좀 고통이라 고민이었습니다.
A.
 패키지 시스템을 잘 역설계해서 사용하는게 중요하다고 생각합니다.
 빌드 스텝을 잘 짜야 하는 문제라고 생각합니다.

7주차 질문

1
Q.
 빌드 플렛폼 별로 생성되고 있는 파일들을 따로 빌드한 대상들을 관리하시는 방법이 있으신가요?
A.
 타겟 정보 외에 호스트 정보도 섞이기 때문에 Ignore 대상으로 만들어서 잊어버립니다.

2
Q.
 프리셋이 일종의 툴체인 찍어내는 틀 같군요
A.
 프리셋이 CMake에서 정식 지원하는 JSon 스크립트 툴이기 때문에 CMake를 쓴다면 이쪽을 사용하시는게 좋다고 생각합니다.

3
Q.
 CrossPlatform을 주제로 지금까지의 진행 내용을 정리해보면,
 작업을 할 때 순서가 1~6주차의 CMake 작성법을 통해 기본 빌드를 확정하고
 7주차의 Presets 를 통해서 어느 Platform을 선택해서 빌드할 것인가를 결정하는 것이 최종 흐름인 건가요?
A.
 CMake를 읽거나 쓰기 위해서 필요한게 1~4주차 였습니다.
 작성 패턴을 알기 위해서 5~6주차를 썼고
 CMake ToolChain을 사용해서 단순화 할 수 있는 내용을 7주차에서 봤다고 보실 수 있습니다.

4
Q.
 vcpkg의 toolchain폴더를 보니 ios 툴체인이 있는데leetal/ios toolchain을 사용하시는 이유가 따로있을까요?
A.
 vcpkg는 다른 툴체인을 혼용해서 쓰는 것을 주 방식으로 제공하고 있기 때문입니다.
 vcpkg를 쓰면서 leetal/ios toolchain을 쓰면 라이브러리의 추가 제거를 내 마음대로 할 수 있겠다라고 판단할 수 있었습니다.
 VCPKG_CHAINLOAD_TOOLCHAIN_FILE으로 찾아보면 관련 설명이 있습니다.
 CMake를 쓸 때 이렇게 다른 생태계를 엮어서 어떻게 쓸 수 있는지를 생각하고 연계하는 것이 CMake의 운용에 중요한 점입니다.

5
Q.
 CMake 사용 해 봤더니 라이브러리를 사용할 수 있는지에 대해 확인하고 어떤 소스를 사용할지 선택하도록 만들었습니다.
 스위칭 하면서 빌드는 되게 해놓았는데
 옵션에 따라 코드를 달리 하여 빌드할때 use case가 궁금합니다.
A.
 NSync를 보시면 비슷하게 작성되어 있는데 참고하시면 좋을 것 같습니다.

6
Q.
 CMake 사용 해 봤더니 라이브러리를 사용할 수 있는지에 대해 확인하고 어떤 소스를 사용할지 선택하도록 만들었습니다.
 스위칭 하면서 빌드는 되게 해놓았는데
 하위 디렉토리에서 설정한 옵션 변수값을 상위 디렉토리에서 사용할 수 있는 방법
A
 Parent Scope를 사용하면 되긴 하지만 비추천 드리고 NSync를 보시면 비슷하게 작성되어 있는데 참고하시면 좋을 것 같습니다.

7
Q.
 CMake 사용 해 봤더니 라이브러리를 사용할 수 있는지에 대해 확인하고 어떤 소스를 사용할지 선택하도록 만들었습니다.
 스위칭 하면서 빌드는 되게 해놓았는데
 define 값에 따라 빌드되는 코드가 달라 질경우 라이브러리 배포 하는 방법?
A.
 일관적인 인터페이스를 위함인데 매크로는 해더를 사용하는 이상 계속 일관성을 해칠 수 있으므로 CMake 프로젝트로서 public에 놓기에는 적절하지 않다고 생각합니다.
 private 에 놓고 자체적으로 관리하시는게 옳다고 생각합니다.
 CMake Config를 통해 find_package를 통해 자연스럽게 불러오는 형태가 CMake 프로젝트에서 다른 사람들이 이 프로젝트를 이어서 사용할 때 좀 더 안전하게 될 것이라고 생각합니다.

8
Q.
 그러고보니 지금 업무를 보는 프로젝트는 Jenkins에서 변수값을 제어해서 빌드 할 때 Unity 툴체인에 옵션을 주는 것으로 #Define을 제어하던데
 CMake에도 같은 방식이 되는 예제를 알고계신 것이 있나요?
A.
 당장 떠오르는 예제는 없습니다.

9
Q.
 Build 명령에 옵션을 사용자 커스텀으로 줄 수 있는 내용을 추가할 수 있는 방법이 있을까요?
A.
 CMake BuildSet에서 줄 수 있게 되어있는 내용이 있습니다.
 CMake  --preset=arm64-ios 형식으로 사용하게 되는 형태도 있습니다.











